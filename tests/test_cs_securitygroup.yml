- hosts: localhost
  connection: local
  tasks:

# clean setup
  - cs_securitygroup: name=test_sg state=absent

  - cs_securitygroup: name=test_sg
    register: sg
  - assert:
      that:
      - sg|success
      - sg|changed
      - sg.name == "test_sg"

  - cs_securitygroup: name=test_sg
    register: sg
  - assert:
      that:
      - sg|success
      - not sg|changed
      - sg.name == "test_sg"

  - cs_securitygroup: name=test_sg state=absent
    register: sg
  - assert:
      that:
      - sg|success
      - sg|changed
      - sg.name == "test_sg"

  - cs_securitygroup: name=test_sg state=absent
    register: sg
  - assert:
      that:
      - sg|success
      - not sg|changed
      - sg.name is undefined
